<!DOCTYPE html>
<html lang="en">
<head>
    
  <title>Travel and Entertainment Search</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.6.4/angular.min.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.6.4/angular-animate.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/moment@2.22.0/moment.js"></script>
  <script src="https://unpkg.com/masonry-layout@4/dist/masonry.pkgd.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.12.4/css/bootstrap-select.min.css">

<!-- Latest compiled and minified JavaScript -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.12.4/js/bootstrap-select.min.js"></script>

<!-- (Optional) Latest compiled and minified JavaScript translation files -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.12.4/js/i18n/defaults-*.min.js"></script>
<!--    <script defer src="https://use.fontawesome.com/releases/v5.0.9/js/all.js" integrity="sha384-8iPTk2s/jMVj81dnzb/iFR2sdA7u06vHJyyLlAd4snFpCl/SnyUjRrbdJsw1pGIl" crossorigin="anonymous"></script>-->
 
    <script defer src="https://use.fontawesome.com/releases/v5.0.10/js/all.js" integrity="sha384-slN8GvtUJGnv6ca26v8EzVaR9DC58QEwsIk9q1QXdCU8Yu8ck/tL/5szYlBbqmS+" crossorigin="anonymous"></script>
     <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css">
    
    <style>
        .left{
            margin-left:100px;
        }
        .left1{
            margin-left:10px;
        }
        .sizedown{
            width:6.5%;
            height: 35px;
        }
        .sizedown1{
            width:67%;
        }
        .sizeup{
            width:9%;
        }
        .block{
            margin-top:60px;
            
            
        }
        .alginToLeft{
            text-align:left;
        }
        .form-group.required .control-label:after { 
           content:"*";
           color:red;
        }
        .normal{
            font-weight: normal;
        }
        .animation {
          transition: all linear 0s;
          background-color: transparent;
          height: 100%;
          width: 100%;
          position: relative;
          top: 0;
          left: 0px;
        }

        .ng-hide {
          height: 100%;
          width: 100%;
          background-color: transparent;
          top: 0px;
          left: -1000px;
        }
        .transition{
            transition: all linear 0.5s;
            height: 400px;
            background-color: transparent;
            width: 100%;
            position: relative;
            top: 0;
            left: 0;
        }
        .stars-outer {
          display: inline-block;
          position: relative;
          font-family: FontAwesome;
        }

        .stars-outer::before {
          content: "\f006 \f006 \f006 \f006 \f006";
          color:transparent;
        }

        .stars-inner {
          position: absolute;
          top: 0;
          left: 0;
          white-space: nowrap;
          overflow: hidden;
          width: 0;
        }

        .stars-inner::before {
          content: "\f005 \f005 \f005 \f005 \f005";
          color: #f8ce0b;
        }
        .modal {
            display: block; /* Hidden by default */
            position: fixed; /* Stay in place */
            z-index: 1; /* Sit on top */
            padding-top: 100px; /* Location of the box */
            left: 0;
            top: 0;
            width: 100%; /* Full width */
            height: 100%; /* Full height */
            overflow: auto; /* Enable scroll if needed */
            background-color: rgb(0,0,0); /* Fallback color */
            background-color: rgba(0,0,0,0.4); /* Black w/ opacity */
        }

        /* Modal Content */
        .modal-content {
            background-color: #fefefe;
            margin: auto;
            padding: 20px;
            border: 1px solid #888;
            width: 278px;
            height:380px;
        }

        /* The Close Button */
        .close {
            color: #aaaaaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
        }

        .close:hover,
        .close:focus {
            color: #000;
            text-decoration: none;
            cursor: pointer;
        }
        
        .nav > li > a:focus, .nav > li > a:hover {
            border-radius: 4px;
            background-color: cornflowerblue;
            color:white;
        }
        .btn-info:hover {
            color: #fff;
            background-color: cornflowerblue;
            border-color: #269abc;
        }
        .img{
            object-fit: fill;
        }
        .grid {
          background: #EEE;
          max-width: 1200px;
          counter-reset: grid-item;
        }
        .grid-item {
          
          height: 120px;
          float: left;
          background: #D26;
          border: 2px solid #333;
          border-color: hsla(0, 0%, 0%, 0.5);
          border-radius: 5px;
        }
        #mapTo{
            background-color: lightgrey;
        }
        .borderline{
            border: 1px solid;
            border-color:#dee;
        }
        .filledstar{
          color: #f8ce0b;
            
        }
        .square{
            width:20px;
            height:20px;
        }
        .floatRight{
            float:right;
        }
        .twitter{
            content:"\f099";
            
        }
        
        .twitterButton{
            background:url(Twitter.png);
        }
</style>
    
</head>
<body ng-app="myApp" ng-controller="myCtrl">
    
<!--    <div id="map" style="width:100px;height:100px"></div>-->
    <div class="container block"  >
        <div class="panel panel-default" id="divv" style="overflow: hidden;" >
            <form class="form-horizontal" method="GET" style="overflow: hidden; background-color: azure">
    <!--            could be a problem-->
                <div class=" title" style="text-align:center;margin-bottom:10px"><h class="h1" style="font-size:22px;">Travel and Entertainment Search</h></div>
                <div class="form-group" id="keywordBlock">
                    <label class="alginToLeft control-label col-sm-2 normal" for="keyword">Keyword</label>
                    <div class="col-sm-7"><input class="form-control" type="text" name="Keyword" id="Keyword" value=""  required><span class="help-block" id="firstMsg" style="display:none; font-size:10px">Please enter a keyword</span></div><br>
                    
                </div>

                <div class="form-group">
                    <label class="control-label col-sm-2 normal" for="Category">Category </label><div class="col-sm-4">
                        <Select class="form-control" name="Category" id="Category">
                            <option value="default" selected="selected">default</option>

                            <option value="airport">Airport</option>
                            <option value="amusement_Park">Amusement Park</option>
                            <option value="aquarium">Aquarium</option>
                            <option value="art_Gallery">Art Gallery</option>
                            <option value="bakery">Bakery</option>
                            <option value="bar">Bar</option>
                            <option value="beauty_Salon">Beauty Salon</option>
                            <option value="bowling_Alley">Bowling Alley</option>
                            <option value="bus_Station">Bus_Station</option>
                            <option value="cafe">cafe</option>
                            <option value="campground">Campground</option>
                            <option value="car_Rental">Car Rental</option>
                            <option value="casino">Casino</option>
                            <option value="lodging">Lodging</option>
                            <option value="movie_Theater">Movie Theater</option>
                            <option value="museum">Museum</option>
                            <option value="night_Club">Night Club</option>
                            <option value="park">Park</option>
                            <option value="parking">Parking</option>
                            <option value="restaurant">Restaurant</option>
                            <option value="shopping_mall">Shopping Mall</option>
                            <option value="stadium">Stadium</option>
                            <option value="subway_station">Subway Station</option>
                            <option value="taxi_stand">Taxi Stand</option>
                            <option value="train_station">Train Station</option>
                            <option value="transit_station">Transit Station</option>
                            <option value="travel_agency">Travel Agency</option>
                            <option value="zoo">Zoo</option>


                        </Select>
                    </div>
                </div>
                <div class="form-group">
                    <label class="alginToLeft control-label col-sm-2 normal" for="distance">Distance(miles)</label><div class="col-sm-4">
                    <input class="form-control" type="text" name="distance" id="distance" placeholder="10" value=""></div>
                </div>

                <div id="secondBlock" class="form-group required">
                    <label class="control-label col-sm-2 normal">From </label>
                    <div class="col-sm-10">    
                        <input class="inline" type="radio" name="Here" id="Option1" value="Option1"  onclick="disable()" checked>
                        <label class="normal">Current Location</label><br>
                        <input class="inline" type="radio" name="Here" id="Option2" value="Option2" onclick="enable()">
                        <label class="normal">Other. Please specify</label><br>
                        <input type="text" class="sizedown1 left1 form-control" name="Location" id="customized" value="" placeholder="Enter a location" onFocus=geolocate1() required disabled><span class="help-block" id="secondMsg" style="display:none; font-size:10px">Please enter a location</span>
                    </div>  
                </div>    
                <div class="form-group">

                    <button class="col-sm-1 left btn btn-info" type="submit"  id="submit" ng-click="submitted()" disabled><span class="glyphicon glyphicon-search"></span>Search</button>
                    <button class="btn btn-light" type="reset"  id="clear" onclick="clean()">Clear</button>

                </div>

            </form>
        </div>
        
        
        
    
        
        <div class="progress" ng-hide="progressHide">
            <div id="progress-bar" class="progress-bar progress-bar-striped active" role="progressbar" aria-valuenow="50"
            aria-valuemin="0" aria-valuemax="100" style="width:50%">
            </div>       
        </div>
        
        <ul class="nav text-center" style="">
            <li style="display:inline-block" ng-click="showResults()"><a id="" class="" data-toggle="tab" href="#results">Results</a></li>
            <li style="display:inline-block"><a class="" data-toggle="tab" href="#favorite" >Favorite</a></li>
                    
        </ul>
        
        
        <div class="tab-content transition" ng-show="showBigTable" style="overflow: auto; width:auto">
            <div id="favorite" class="tab-pane fade" >
                
                <div>
                    <table  class="table" style="margin-top:20px">
                        <tr ><p ng-show="showNoFavorite" style="background-color: antiquewhite">No records</p></tr>
                    </table>
                    
                    <table  id='infoTable ' class="table" style = 'width:100%;'ng-hide="showNoFavorite">
                        <tr>
                            <td><h style='font-weight:bold;'>#</h></td>
                            <td><h style='font-weight:bold;'>Category</h></td>
                            <td><h style='font-weight:bold;'>Name</h></td>
                            <td><h style='font-weight:bold;'>Address</h></td>
                            <td><h style='font-weight:bold;'>Favorite</h></td>
                            <td><h style='font-weight:bold;'>Details</h></td>
                        </tr>
                        <tr ng-repeat="x in favoritePlaces" >
                            <td id="index">{{$index+1}}</td>
                            <td><img src={{x.icon}}></td>
                            <td><p >{{x.name}}</p></td>
                            <td><p >{{x.vicinity}}</p></td>
                            <td><button class="btn btn-default" style='font-size:20px' ng-click="removeFavorite(this)"><i class="fas fa-trash"></i></button></td>
                            <td><button id={{$index+1}} class="btn btn-default" style='font-size:20px' value={{x.place_id}} ng-click=disappearAndGetDetails(x.place_id,x.name,this) ><i class='fa fa-angle-right'></i></button></td>
                        </tr>
                          
                    </table>
                    <div style="text-align: center">
                            <button class="btn-default" ng-show="showNext" ng-click="clickNext()">Next</button>
                            <button class="btn-default" ng-show="showPrevious" ng-click="clickPrev()">Previous</button>
                    </div>
                </div>
            </div>
            
            
            <div id="results" class="tab-pane fade in active" style="overflow: auto; ">
                <div ng-show="NoRecordResult">
                 <p style='background-color: antiquewhite;margin-top:50px;margin-bottom:50px'>No records</p>
                </div>    
                <div ng-hide="tableHide" id="resultTable" class="animation">
                    
                    <div class="row">
                        <button id="details2" class="btn btn-default" ng-click="showDetails2()" style="float:right;" disabled><i class="fa fa-angle-right"></i>Details</button>
                    </div>
                    
                    
                    <table  id='infoTable ' class="table" style = 'width:100%;' style="overflow: auto; ">
                        
                        
                        <tr>
                            <td><h style='font-weight:bold;'>#</h></td>
                            <td><h style='font-weight:bold;'>Category</h></td>
                            <td><h style='font-weight:bold;'>Name</h></td>
                            <td><h style='font-weight:bold;'>Address</h></td>
                            <td><h style='font-weight:bold;'>Favorite</h></td>
                            <td><h style='font-weight:bold;'>Details</h></td>
                        </tr>
                        <tr ng-repeat="x in places" id={{x.place_id}}>
                            <td>{{$index+1}}</td>
                            <td><img src={{x.icon}}></td>
                            <td><p id={{$index+1}}>{{x.name}}</p></td>
                            <td style="white-space:nowrap"><p style="display:inline;white-space:nowrap">{{x.vicinity}}</p></td>
                            <td><button id={{x.place_id}} class="btn" style='font-size:20px' ng-click="saveRemoveFavorite(this)"><i class='fa fa-star'></i></button></td>
                            <td><button class="btn btn-default" style='font-size:20px' value={{x.place_id}} ng-click=disappearAndGetDetails(x.place_id,x.name,this) ><i class='fa fa-angle-right'></i></button></td>
                        </tr>

                    </table>
                    <div style="text-align: center">
                            <button class="btn btn-default" ng-show="showNext" ng-click="clickNext()">Next</button>
                            <button class="btn btn-default" ng-show="showPrevious" ng-click="clickPrev()">Previous</button>
                    </div>
                </div>
                
                <div ng-hide="secondTableHide" id="secondTable" class="animation">
                    <div class="row">
                        <button id="details3" class="btn btn-default" ng-click="showDetails2()" style="float:right;" disabled><i class="fa fa-angle-right"></i>Details</button>
                    </div>
                    <table  id='secondInfoTable ' class="table" style = 'width:100%;' style="overflow: auto; ">
                        <tr>
                            <td><h style='font-weight:bold;'>#</h></td>
                            <td><h style='font-weight:bold;'>Category</h></td>
                            <td><h style='font-weight:bold;'>Name</h></td>
                            <td><h style='font-weight:bold;'>Address</h></td>
                            <td><h style='font-weight:bold;'>Favorite</h></td>
                            <td><h style='font-weight:bold;'>Details</h></td>
                        </tr>
                        <tr ng-repeat="x in secondPlaces" id={{x.place_id}}>
                            <td>{{$index+1}}</td>
                            <td><img src={{x.icon}}></td>
                            <td><p id={{$index+1}}>{{x.name}}</p></td>
                            <td style="white-space:nowrap"><p style="display:inline;white-space:nowrap">{{x.vicinity}}</p></td>
                            <td><button id={{x.place_id}} class="btn" style='font-size:20px' ng-click="saveRemoveFavorite(this)"><i class='fa fa-star'></i></button></td>
                            <td><button class="btn btn-default" style='font-size:20px' value={{x.place_id}} ng-click=disappearAndGetDetails(x.place_id,x.name,this) ><i class='fa fa-angle-right'></i></button></td>
                        </tr>

                    </table>
                    <div style="text-align: center">
                            <button class="btn btn-default" ng-show="secondShowNext" ng-click="secondClickNext()">Next</button>
                            <button class="btn btn-default" ng-show="secondShowPrev" ng-click="secondClickPrev()">Previous</button>
                    </div>
                </div>
                
                <div ng-hide="thirdTableHide" id="thirdTable" class="animation">
                    <div class="row">
                        <button id="details4" class="btn btn-default" ng-click="showDetails3()" style="float:right;" disabled><i class="fa fa-angle-right"></i>Details</button>
                    </div>
                    <table  id='thirdInfoTable ' class="table" style = 'width:100%;' style="overflow: auto; ">
                        <tr>
                            <td><h style='font-weight:bold;'>#</h></td>
                            <td><h style='font-weight:bold;'>Category</h></td>
                            <td><h style='font-weight:bold;'>Name</h></td>
                            <td><h style='font-weight:bold;'>Address</h></td>
                            <td><h style='font-weight:bold;'>Favorite</h></td>
                            <td><h style='font-weight:bold;'>Details</h></td>
                        </tr>
                        <tr ng-repeat="x in thirdPlaces" id={{x.place_id}}>
                            <td>{{$index+1}}</td>
                            <td><img src={{x.icon}}></td>
                            <td><p id={{$index+1}}>{{x.name}}</p></td>
                            <td style="white-space:nowrap"><p style="display:inline;white-space:nowrap">{{x.vicinity}}</p></td>
                            <td><button id={{x.place_id}} class="btn" style='font-size:20px' ng-click="saveRemoveFavorite(this)"><i class='fa fa-star'></i></button></td>
                            <td><button class="btn btn-default" style='font-size:20px' value={{x.place_id}} ng-click=disappearAndGetDetails(x.place_id,x.name,this) ><i class='fa fa-angle-right'></i></button></td>
                        </tr>

                    </table>
                    <div style="text-align: center">
                            
                            <button class="btn btn-default" ng-show="thirdShowPrev" ng-click="thirdClickPrev()">Previous</button>
                    </div>
                </div>
<!--
                <div ng-hide="secondTableHide">
                    <table  id='secondTable' class="table" style = 'width:100%;' >
                        <tr>
                            <td><h style='font-weight:bold;'>#</h></td>
                            <td><h style='font-weight:bold;'>Category</h></td>
                            <td><h style='font-weight:bold;'>Name</h></td>
                            <td><h style='font-weight:bold;'>Address</h></td>
                            <td><h style='font-weight:bold;'>Favorite</h></td>
                            <td><h style='font-weight:bold;'>Details</h></td>
                        </tr>
                        <tr ng-repeat="x in secondPlaces" >
                            <td>{{$index+1}}</td>
                            <td><img src={{x.icon}}></td>
                            <td><p>{{x.name}}</p></td>
                            <td><p>{{x.vicinity}}</p></td>
                            <td><button style='font-size:20px' ><i class='fa fa-star-o'></i></button></td>
                            <td><button id={{$index+1}} style='font-size:20px' value={{x.place_id}} ng-click=secondGetDetails(this) ><i class='fa fa-angle-right'></i></button></td>
                        </tr>

                    </table>
                    <div style="text-align: center">
                            <button class="btn-default" ng-show="secondShowNext" ng-click="secondClickNext()">Next</button>
                            <button class="btn-default" ng-show="secondShowPrev" ng-click="secondClickPrev()">Previous</button>
                    </div>
                </div>
-->
                
                
                
                <div id="detailsDiv" ng-hide="detailsHide" class="animation">
                    
                    <div class="row">
                        <button class="btn btn-default" ng-click="toggleAgain()" style="float:left;margin-left:20px"><i class="fa fa-angle-left"></i>List</button>

                        
                        <button  id="twitterButton" class="btn" onclick="showTwitter()" style="display:inline-block;float:right;width:40px;padding:0px"><img src="download.png" style="max-width:100%;"></button>
                        <button ng-click="fav2()" id='fav2' class='btn btn-default' style='background-color:white;border-color:lightgray;margin-right:10px;float:right'><i class='fa fa-star'></i></button>

                        
                    </div>
                    
                    
                    <ul class="nav nav-tabs">

                        <li id="reviewTab" style="float:right"><a data-toggle="tab" href="#Reviews">Reviews</a></li>
                        <li id="mapTab" style="float:right"><a data-toggle="tab" href="#Map" onclick="putInput()">Map</a></li>
                        <li id="photoTab" style="float:right"><a data-toggle="tab" href="#Photos">Photos</a></li>
                        <li id="infoTab" class="active" style="float:right"><a data-toggle="tab" href="#Info">Info</a></li>
                    </ul>

                    <div class="tab-content">

                        <div id="Info" class="tab-pane fade in active">
                            <table class="table">
                                <div class='row' id="placeName" style="text-align:center;font-weight:bold;font-size:20px;margin:30px"></div>
                                <tr>
                                    <td><h style='font-weight:bold;'>Address</h></td>
                                    <td><p id="address">{{address}}</p></td>
                                </tr>
                                <tr id="phoneNumber">
                                    <td><h style='font-weight:bold;'>Phone Number</h></td>
                                    <td><p>{{phoneNumber}}</p></td>
                                </tr>
                                <tr id="price">
                                    <td><h style='font-weight:bold;'>Price Level</h></td>
                                    <td><p>{{priceLevel}}</p></td>
                                </tr>
                                <tr id="rating">
                                    <td><h  style='font-weight:bold;'>Rating</h></td>
                                    <td>{{rating}}
                                       <div class="stars-outer">
                                          <div id ="rating_star" class="stars-inner"></div>
                                       </div> 

                                    </td>
                                </tr>
                                <tr id="page">
                                    <td><h style='font-weight:bold;'>Google Page</h></td>
                                    <td><a id="googlePage" href={{page}}>{{page}}</a></td>
                                </tr>
                                <tr>
                                    <td><h style='font-weight:bold;'>Website</h></td>
                                    <td><a id="website" href={{website}}>{{website}}</a></td>
                                </tr>
                                <tr id="hours">
                                    <td><h style='font-weight:bold;'>Hours</h></td>
                                    <td><p>{{hours}} <a ng-click="showModalFunc()" style="text-decoration: underline">Daily Open Hours</a></p> </td>
                                </tr>
                            </table>
                        </div>

                        <div id="Photos" class="tab-pane fade">
                            <div id="NoRecordPhotos" >
                             <p style='background-color: antiquewhite;margin-top:50px;margin-bottom:50px'>No records</p>
                            </div>
                            <div id="photos" class="container"></div>
                        </div>

                        <div id="Map" class="tab-pane fade">
                            <tr>
                                <div class="col-sm-4">From</div>
                                <div class="col-sm-4">To</div>
                                <div class=col-sm-4>Travel Mode</div>
                            </tr>
                            <tr>
                                <div class="col-sm-4">
                                    <input id ="mapFrom" class ="form-control" type=text value="Your location" onclick="geolocate2()">
                                </div>
                                <div class="col-sm-4">
                                    <input id="mapTo" class ="form-control" type=text readonly>
                                </div>
                                <div class="col-sm-2">
                                    <select id="travelMode" class ="form-control">
                                        <option value="DRIVING">Driving</option>
                                        <option value="WALKING">Walking</option>
                                        <option value="BICYCLING">Bicycling</option>
                                    </select>
                                </div>
                                
                                <button id="getDirection" type="button" class="btn btn-info" >Get Direction</button>
                            </tr>
                            <div class="row">
                                <div class="col-sm-2">
                                <button  class="btn btn-default" onclick="toggleStreetView()" style="float:left;width:40px;padding:0px"><img id="streetView" src="street.png" style="width:40px"></button>
                                </div>    
                            </div>    
                            <div class="container" id="mapHere" style="width:100%;height:300px"></div>
                            <div id="routes"></div>
                            <div id="panel"></div>
                        </div>

                        <div id="Reviews" class="tab-pane fade">
                            
                            <div id="twoButtons"></div>
                            <div ng-show="NoRecordReview">
                                <p style='background-color: antiquewhite;margin-top:50px;margin-bottom:50px'>No records</p>
                            </div>
                            <div id="reviewContent" ng-hide="NoRecordReview"></div>
                        </div>

                    </div>
                </div>
                    
            </div>    
        </div>    
        <div id="myModal" class="modal" ng-show="showModal">
            <div class="container modal-content">
                <span ng-click="closeModal()" class="close">&times;</span>
                <h style="font-weight: bold">Open Hours</h>
                <table class="table">
                    <tr>
                        <td  style="font-weight:bold">{{Aday}}</td>
                        <td  style="font-weight:bold">{{Atext}}</td>
                    </tr>
                    <tr>
                        <td>{{Bday}}</td>
                        <td>{{Btext}}</td>
                    </tr>
                    <tr>
                        <td>{{Cday}}</td>
                        <td>{{Ctext}}</td>
                    </tr>
                    <tr>
                        <td>{{Dday}}</td>
                        <td>{{Dtext}}</td>
                    </tr>
                    <tr>
                        <td>{{Eday}}</td>
                        <td>{{Etext}}</td>
                    </tr>
                    <tr>
                        <td>{{Fday}}</td>
                        <td>{{Ftext}}</td>
                    </tr>
                    <tr>
                        <td>{{Gday}}</td>
                        <td>{{Gtext}}</td>
                    </tr>

                </table>
                <button type="button" class="btn" ng-click="closeModal()" style="background-color:#A9A9A9;float:right">Close</button>
            </div>
        </div>
    </div>
    <div id="mapHelper"></div>
</body>
    
<script>
    
    var count = 0;
    var object;
    var destLat;
    var destLon;
    var toggleCount = 0;
    //localStorage.removeItem("list");
    var app = angular.module('myApp', ['ngAnimate']);    
    app.controller('myCtrl', Ctrl);
    
    
    function Ctrl($http, $scope){
        
        //localStorage.removeItem("list");
        $scope.tableHide = true;
        $scope.secondTableHide = true;
        $scope.secondShowPrev = false;
        $scope.secondShowNext = false;
        $scope.thirdTableHide = true;
        $scope.thirdShowPrev = false;
        
        $scope.progressHide=true;
        $scope.detailsHide=true;
        $scope.showModal = false;
        $scope.showNext=false;
        $scope.showPrevious=false;
        $scope.showBigTable = true;
        
        //var favorite=[];
        if(localStorage.list){
            $scope.favoritePlaces=JSON.parse(localStorage.getItem("list"));
            if($scope.favoritePlaces.length!=0){
                $scope.showNoFavorite = false;
            }else{
                $scope.showNoFavorite = true;
            }
                
        }else{
            $scope.showNoFavorite = true;
            localStorage.setItem("list","[]");
        }
        $scope.fav2 = function(){
            
            saveRemove(object);
        }
        $scope.showDetails2 = function(){
            document.getElementById("resultTable").style.transition ="all linear 0s";
            $scope.tableHide = true;
            
            document.getElementById("detailsDiv").style.transition ="all linear 0.5s";
             $scope.detailsHide = false;
            
        }
        $scope.showDetails3 = function(){
            document.getElementById("secondTable").style.transition ="all linear 0s";
            $scope.secondTableHide = true;
            
            document.getElementById("detailsDiv").style.transition ="all linear 0.5s";
             $scope.detailsHide = false;
            
        }
        
        $scope.showSecondDetails = function(){
            document.getElementById("secondTable").style.transition ="all linear 0s";
            $scope.secondTableHide = true;
            
            document.getElementById("detailsDiv").style.transition ="all linear 0.5s";
             $scope.detailsHide = false;
            
        }
        
        
        $scope.removeFavorite = function(obj){
            
            
            var favorites = JSON.parse(localStorage.getItem("list"));
                var index = getIndex(favorites,obj.x);
                favorites.splice(index,1);
               console.log("after remove");
                console.log(favorites);
                localStorage.setItem("list",JSON.stringify(favorites));
                $scope.favoritePlaces = favorites;
                if($scope.favoritePlaces.length==0){
                    $scope.showNoFavorite = true;
                }
                
        }
        $scope.saveRemoveFavorite = saveRemove;
        
            function  saveRemove(obj){
            console.log("count");
            console.log(count);
            //object = obj;
            var favorites = JSON.parse(localStorage.getItem("list"));
            
            if(!contains(favorites,obj.x)){
                
                //console.log(obj.$index);
                favorites.push(obj.x);
                localStorage.setItem("list", JSON.stringify(favorites));
                $scope.showNoFavorite = false;
                $scope.favoritePlaces = favorites;
                //console.log($scope.favoritePlaces);
                
                
            }
            else{
                 var index = getIndex(favorites,obj.x);
                favorites.splice(index,1);
                console.log("after remove");
                console.log(favorites);
                localStorage.setItem("list",JSON.stringify(favorites));
                $scope.favoritePlaces = favorites;
                if($scope.favoritePlaces.length==0){
                    $scope.showNoFavorite = true;
                }
            }
        }
        
        
        
        
        $scope.toggleAgain = function(){
            //console.log("toggled");
             document.getElementById("detailsDiv").style.transition ="all linear 0s";
            
            //document.getElementById("resultTable").style.display = "block";
            
            document.getElementById("resultTable").style.transition ="all linear 0.5s";
            $scope.detailsHide = true;
            document.getElementById("detailsDiv").style.transition ="all linear 0s";
            $scope.tableHide = false;
            
        }
        
        
        
        $scope.disappearAndGetDetails = function(place_id,place_name,obj){
            $("#Info").addClass("in active");
            $("#infoTab").addClass("active");
            $("#mapTab").removeClass("active");
            $("#reviewTab").removeClass("active");
            $("#photoTab").removeClass("active");
            $("#Map").removeClass("active");
            $("#Reviews").removeClass("active");
            $("#Photos").removeClass("active");
            
            $("tr").css("background-color","transparent");
            $("#"+place_id).css("background-color","#e6b800");
            $("#details2").prop("disabled",false);
            $("#details3").prop("disabled",false);
            
//            console.log("abcd");
//            console.log($("#"+place_id));
            console.log("obj is");
            console.log(obj.x.geometry.location.lat);
            initMap(obj.x.geometry.location.lat,obj.x.geometry.location.lng);
            object = obj;
            showPhotos(place_id);
            document.getElementById("placeName").innerHTML= place_name;
//            document.getElementById("twitterButton").disabled =false;
//            document.getElementById("favButton").disabled =false;
            
            
            //document.getElementById("resultTable").style.display = "none";
            
            document.getElementById("resultTable").style.transition ="all linear 0s";
            $scope.tableHide = true;
            document.getElementById("secondTable").style.transition ="all linear 0s";
            $scope.secondTableHide = true;
            document.getElementById("thirdTable").style.transition ="all linear 0s";
            $scope.thirdTableHide = true;
            //console.log(place_id);
			//$scope.tableHide = true;
            
            var url = "http://hw8nodejs.us-east-2.elasticbeanstalk.com/hw8/getGoogleDetails?placeid="+place_id;
            
             $http({
                        method:"GET",
                        url:url,
                }).then(function (response){
                 //error handling needed
                    //initMap();
                    console.log("details data");
                    console.log(response.data);
                    $scope.address= response.data.result.formatted_address;
                    if(response.data.result.international_phone_number){
                       $scope.phoneNumber=response.data.result.international_phone_number;
                        $("#phoneNumber").show();
                       }
                    else{
                        $scope.phoneNumber=0;
                        $("#phoneNumber").hide();
                    }
                    if(response.data.result.price_level){
                       
                       $scope.priceLevel=fillPrice(response.data.result.price_level);
                        $("#price").show();
                       }
                    else{
                        $scope.priceLevel=0;
                        $("#price").hide();
                    }
                    if(response.data.result.rating){
                       $scope.rating=response.data.result.rating;
                        fillstar(response.data.result.rating,"rating_star");
                       
                        $("#rating").show();
                       }
                    else{
                        $scope.rating=0;
                        $("#rating").hide();
                    }
                    if(response.data.result.url){
                       $scope.page=response.data.result.url;
                        $("#page").show();
                    }
                    else{
                        $scope.page=0;
                        $("#page").hide();
                    }
                    if(response.data.result.website){
                       $scope.website=response.data.result.website;
                        $("#website").show();
                       }
                    else{
                        $scope.website=0;
                        $("#website").hide();
                    }
                    if(response.data.result.opening_hours){
                       $scope.hours=fillHours(response.data.result.opening_hours,response.data.result.utc_offset);
                        fillModal(response.data.result.opening_hours,response.data.result.utc_offset);
                        $("#hours").show();
                       }
                    else{
                        $scope.hours=0;
                        $("#hours").hide();
                    }
                    
                    
                    
                    //$scope.showModal = true;
                     document.getElementById("detailsDiv").style.transition ="all linear 0.5s";
                    $scope.detailsHide=false;
                   
                    //console.log(response.data.result.reviews)
                    var city = findCity(response.data.result);
                    var state = findState(response.data.result);
                    console.log("city");
                    console.log(city+" "+state);
                    var googleReviews = response.data.result.reviews;
                    var empty = [];
                    writeReviewsBlock(googleReviews,empty);
                     var url = "http://hw8nodejs.us-east-2.elasticbeanstalk.com/hw8/getDetails?name="+place_name+"&address1="+response.data.result.address_components[0].short_name+" "+response.data.result.address_components[1].short_name+"&city="+city+"&state="+state+"&country=US";
                    console.log(url);
                    $http({
                        method:"GET",
                        url:url,
                    }).then(function (response){
                           console.log("got yelp id");
                            console.log(response);
                            //alert(test);
                            if(response.data.businesses[0]){
                                var yelpPlaceId = response.data.businesses[0].id;
                                var url= "http://hw8nodejs.us-east-2.elasticbeanstalk.com/hw8/getReview?place_id="+yelpPlaceId;
                                console.log(url);
                                $http({
                                method:"GET",
                                url:url,
                                }).then(function (response){
                                    console.log("got yelp response");

                                    writeReviewsBlock(googleReviews ,response.data.reviews);

                                })
                                
                            }
                            
                    }) 
                })

        }
        $scope.clickNext = function(){
            console.log($scope.second_page_token);
            var url = "http://hw8nodejs.us-east-2.elasticbeanstalk.com/hw8/getNext?pagetoken="+$scope.second_page_token;
            console.log(url);
            $http({
                    method:"GET",
                    url:url,
                }).then(function (response){
                    //console.log(response.data);
                    $scope.secondPlaces = response.data.results;
                    console.log($scope.secondPlaces);
                    document.getElementById("resultTable").style.transition ="all linear 0s";
                    $scope.tableHide = true;
                    $scope.secondTableHide = false;
                    $scope.secondShowNext = true;
                    $scope.secondShowPrev = true;
                    $scope.third_page_token = response.data.next_page_token;
                    console.log(response.data.next_page_token);
                    
                })
        }
        $scope.secondClickNext = function(){
            
            if($scope.third_page_token){
               var url = "http://hw8nodejs.us-east-2.elasticbeanstalk.com/hw8/getNext?pagetoken="+$scope.third_page_token;
            $http({
                    method:"GET",
                    url:url,
                }).then(function (response){
                    //console.log(response.data);
                    $scope.thirdPlaces = response.data.results;
                    console.log($scope.thirdPlaces);
                    document.getElementById("secondTable").style.transition ="all linear 0s";
                    $scope.secondTableHide = true;
                    $scope.thirdTableHide = false;
                    
                    $scope.thirdShowPrev = true;
                    
                    
                })}
        }
        
        $scope.secondClickPrev = function(){
            document.getElementById("resultTable").style.transition ="all linear 0s";
            $scope.secondTableHide = true;
            $scope.tableHide = false;
        }
        $scope.secondGetDetails = function(tag){
            $scope.secondTableHide = true;
            $scope.disappearAndGetDetails(tag);
        }
        $scope.thirdClickPrev = function(){
            document.getElementById("secondTable").style.transition ="all linear 0s";
            $scope.thirdTableHide = true;
            $scope.secondTableHide = false;
        }
        
        
        
        
        $scope.showModalFunc = function(){
            document.getElementById("myModal").style.display="block";
            $scope.showModal = true;
//            var modal = Document.getElementById('myModal');
//            modal.style.display = "block";
        }
        $scope.closeModal = function(){
            $scope.showModal =false;
            document.getElementById("myModal").style.display="none";
        }
        $scope.submitted=function(){
            
            $("#details2").prop("disabled",true);
            $("#details3").prop("disabled",true);
            
            $scope.progressHide=false;
            $scope.detailsHide=true;
            
            console.log("click event fired");
            if($("#Option2").is(':checked')){
                var url = "http://hw8nodejs.us-east-2.elasticbeanstalk.com/hw8/geoCoding?location="+$("#customized").val();
                console.log(url);
                $http({
                    method:"GET",
                    url:url,
                }).then(function(response){
                        //initMap(response.data.results[0].geometry.location.lat,response.data.results[0].geometry.location.lng);
                        console.log("distance");
                        console.log($("#distance").val());
                        var distance = $("#distance").val()? $("#distance").val():10;
                        console.log($("#Category").val());
                        var url = "http://hw8nodejs.us-east-2.elasticbeanstalk.com/hw8/geoNearby?location="+$("#customized").val()+"&radius="+distance*1609+"&type="+$("#Category").val()+"&keyword="+$("#Keyword").val();
                        console.log(url);
                        $http({
                                method:"GET",
                                url:url,
                        }).then(function (response){
                            console.log(response.data);
                            //!!!
                            
                            if(response.data.results.length!=0){
                                console.log("that path");
                                $scope.places=response.data.results;
                                $scope.table=false;
                                $scope.progressHide=true;
                                $scope.tableHide=false; 
                                $scope.NoRecordResult = false;
                                
                            }else{
                                console.log("this path");
                                $scope.table=false;
                                $scope.progressHide=true;
                                $scope.tableHide=true; 
                                $scope.NoRecordResult = true;
                                
                            }
                            //error handling!
                            

                            if(response.data.next_page_token){
                                $scope.second_page_token = response.data.next_page_token;
                                $scope.showNext = true;
                            }
                        })    
                
                    
                    })
                
                
                

            }
            
            else{
                var ipJson=JSON.parse(ipApi());
                //initMap(ipJson.lat,ipJson.lon);
                var distance = $("#distance").val()? $("#distance").val():10;
                var url = "http://hw8nodejs.us-east-2.elasticbeanstalk.com/hw8/getNearby?location="+ipJson.lat+","+ipJson.lon+"&radius="+distance*1609+"&type="+$("#Category").find(":selected").text()+"&keyword="+$("#Keyword").val();
                console.log(url);
                $http({
                        method:"GET",
                        url:url,
                }).then(function (response){
                    console.log(response.data);
                    
                    
                    if(response.data.results.length!=0){
                        console.log("that path");
                        $scope.places=response.data.results;
                        $scope.table=false;
                        $scope.progressHide=true;
                        $scope.tableHide=false; 
                        $scope.NoRecordResult = false;
                                
                    }else{
                        console.log("this path");
                        $scope.table=false;
                        $scope.progressHide=true;
                        $scope.tableHide=true; 
                        $scope.NoRecordResult = true;

                    }
                    
                    
                    
                    if(response.data.next_page_token){
                        $scope.second_page_token = response.data.next_page_token;
                        $scope.showNext = true;
                    }
                })
            }
        }
        function findCity(obj){
            //console.log(obj.address_components);
            var i;
            for(i=0;i<obj.address_components.length;i++){
                console.log(obj.address_components[i]);
                if (obj.address_components[i].types[0] =="locality"){
                     return obj.address_components[i].short_name;
                }
            }
            return null;
        }
        function findState(obj){
//            for(component in obj.address_components){
//                if (component.types[0] =="administrative_area_level_1"){
//                     return component.short_name;
//                }
//            }
//            return null;
            var i;
            for(i=0;i<obj.address_components.length;i++){
                console.log(obj.address_components[i]);
                if (obj.address_components[i].types[0] =="administrative_area_level_1"){
                     return obj.address_components[i].short_name;
                }
            }
            return null;
        }
        
        function fillModal(obj,utc_offset){
            
            var day = moment().utcOffset(utc_offset).format('dddd');
            console.log(day);
            if (day == "Monday"){
                $scope.Aday="Monday";
                $scope.Atext=obj.weekday_text[0].replace("Monday:","");
                $scope.Bday="Tuesday";
                $scope.Btext=obj.weekday_text[1].replace("Tuesday:","");
                $scope.Cday="Wednesday";
                $scope.Ctext=obj.weekday_text[2].replace("Wednesday:","");
                $scope.Dday="Thursday";
                $scope.Dtext=obj.weekday_text[3].replace("Thursday:","");
                $scope.Eday="Friday";
                $scope.Etext=obj.weekday_text[4].replace("Friday:","");
                $scope.Fday="Saturday";
                $scope.Ftext=obj.weekday_text[5].replace("Saturday:","");
                $scope.Gday="Sunday";
                $scope.Gtext=obj.weekday_text[6].replace("Sunday:","");
                
            }
            if (day == "Tuesday"){
                $scope.Gday="Monday";
                $scope.Gtext=obj.weekday_text[0].replace("Monday:","");
                $scope.Aday="Tuesday";
                $scope.Atext=obj.weekday_text[1].replace("Tuesday:","");
                $scope.Bday="Wednesday";
                $scope.Btext=obj.weekday_text[2].replace("Wednesday:","");
                $scope.Cday="Thursday";
                $scope.Ctext=obj.weekday_text[3].replace("Thursday:","");
                $scope.Dday="Friday";
                $scope.Dtext=obj.weekday_text[4].replace("Friday:","");
                $scope.Eday="Saturday";
                $scope.Etext=obj.weekday_text[5].replace("Saturday:","");
                $scope.Fday="Sunday";
                $scope.Ftext=obj.weekday_text[6].replace("Sunday:","");
                
            }
            if (day == "Wednesday"){
                $scope.Fday="Monday";
                $scope.Ftext=obj.weekday_text[0].replace("Monday:","");
                $scope.Gday="Tuesday";
                $scope.Gtext=obj.weekday_text[1].replace("Tuesday:","");
                $scope.Aday="Wednesday";
                $scope.Atext=obj.weekday_text[2].replace("Wednesday:","");
                $scope.Bday="Thursday";
                $scope.Btext=obj.weekday_text[3].replace("Thursday:","");
                $scope.Cday="Friday";
                $scope.Ctext=obj.weekday_text[4].replace("Friday:","");
                $scope.Dday="Saturday";
                $scope.Dtext=obj.weekday_text[5].replace("Saturday:","");
                $scope.Eday="Sunday";
                $scope.Etext=obj.weekday_text[6].replace("Sunday:","");
                
            }
            if (day == "Thursday"){
                $scope.Eday="Monday";
                $scope.Etext=obj.weekday_text[0].replace("Monday:","");
                $scope.Fday="Tuesday";
                $scope.Ftext=obj.weekday_text[1].replace("Tuesday:","");
                $scope.Gday="Wednesday";
                $scope.Gtext=obj.weekday_text[2].replace("Wednesday:","");
                $scope.Aday="Thursday";
                $scope.Atext=obj.weekday_text[3].replace("Thursday:","");
                $scope.Bday="Friday";
                $scope.Btext=obj.weekday_text[4].replace("Friday:","");
                $scope.Cday="Saturday";
                $scope.Ctext=obj.weekday_text[5].replace("Saturday:","");
                $scope.Dday="Sunday";
                $scope.Dtext=obj.weekday_text[6].replace("Sunday:","");
                
            }
            if (day == "Friday"){
                $scope.Dday="Monday";
                $scope.Dtext=obj.weekday_text[0].replace("Monday:","");
                $scope.Eday="Tuesday";
                $scope.Etext=obj.weekday_text[1].replace("Tuesday:","");
                $scope.Fday="Wednesday";
                $scope.Ftext=obj.weekday_text[2].replace("Wednesday:","");
                $scope.Gday="Thursday";
                $scope.Gtext=obj.weekday_text[3].replace("Thursday:","");
                $scope.Aday="Friday";
                $scope.Atext=obj.weekday_text[4].replace("Friday:","");
                $scope.Bday="Saturday";
                $scope.Btext=obj.weekday_text[5].replace("Saturday:","");
                $scope.Cday="Sunday";
                $scope.Ctext=obj.weekday_text[6].replace("Sunday:","");
                
            }
            if (day == "Saturday"){
                $scope.Cday="Monday";
                $scope.Ctext=obj.weekday_text[0].replace("Monday:","");
                $scope.Dday="Tuesday";
                $scope.Dtext=obj.weekday_text[1].replace("Tuesday:","");
                $scope.Eday="Wednesday";
                $scope.Etext=obj.weekday_text[2].replace("Wednesday:","");
                $scope.Fday="Thursday";
                $scope.Ftext=obj.weekday_text[3].replace("Thursday:","");
                $scope.Gday="Friday";
                $scope.Gtext=obj.weekday_text[4].replace("Friday:","");
                $scope.Aday="Saturday";
                $scope.Atext=obj.weekday_text[5].replace("Saturday:","");
                $scope.Bday="Sunday";
                $scope.Btext=obj.weekday_text[6].replace("Sunday:","");
                
                
            }
            if (day == "Sunday"){
                $scope.Bday="Monday";
                $scope.Btext=obj.weekday_text[0].replace("Monday:","");
                $scope.Cday="Tuesday";
                $scope.Ctext=obj.weekday_text[1].replace("Tuesday:","");
                $scope.Dday="Wednesday";
                $scope.Dtext=obj.weekday_text[2].replace("Wednesday:","");
                $scope.Eday="Thursday";
                $scope.Etext=obj.weekday_text[3].replace("Thursday:","");
                $scope.Fday="Friday";
                $scope.Ftext=obj.weekday_text[4].replace("Friday:","");
                $scope.Gday="Saturday";
                $scope.Gtext=obj.weekday_text[5].replace("Saturday:","");
                $scope.Aday="Sunday";
                $scope.Atext=obj.weekday_text[6].replace("Sunday:","");
                
            } 

            
        }
        
            
        

//}
                            
    }

          var autocomplete1;
          var autocomplete2;
          var panorama;
            
    
          var componentForm = {
            street_number: 'short_name',
            route: 'long_name',
            locality: 'long_name',
            administrative_area_level_1: 'short_name',
            country: 'long_name',
            postal_code: 'short_name'
          };
    
            $('#divv #Keyword, #divv #customized').on('change', checkForm);
            $('#divv #Keyword').on('change', keywordValid);
            $('#divv #customized').on('change', locationValid);
            function checkForm(){
                console.log(" checked");
                 if((keywordValid()&&(!document.getElementById("Option2").checked)) || (keywordValid()&&document.getElementById("Option2").checked&&locationValid())){
                        console.log("success");
                     console.log(document.getElementById("Option2").checked);
                     console.log(locationValid);
                         $("#submit").prop('disabled', false);
                 }else{
                     $("#submit").prop('disabled', true);
                 }
                    
            }
            function keywordValid(){
                if((!/^ *$/.test($("#Keyword").val())) && ($("#Keyword").val()!="")){
                    
                    $("#keywordBlock").removeClass("has-warning");
                    document.getElementById("firstMsg").style.display = "none";
                    return true;
                }
                else{
                   $("#keywordBlock").addClass("has-warning");
                    document.getElementById("firstMsg").style.display = "block";
                    return false;
                }
            }
            
            function locationValid(){
                console.log("locationvaldign");
                if((!/^ *$/.test($("#customized").val()))&&($("#customized").val()!="")){
                    console.log("location true");
                     $("#secondBlock").removeClass("has-warning");
                    document.getElementById("secondMsg").style.display = "none";
                    return true;
                }
                else{
                    console.log("location false");
                     $("#secondBlock").addClass("has-warning");
                    document.getElementById("secondMsg").style.display = "block";
                    return false;
                }
            }
            
            function showTwitter(){
                console.log("aaa");
                var name = document.getElementById("placeName").innerHTML;
                var address=  document.getElementById("address").innerHTML;
                if(document.getElementById("website")){
                    var website = document.getElementById("website").innerHTML;
                }else{
                    var website = document.getElementById("googlePage").innerHTML
                }
                console.log();
                var url="https://twitter.com/intent/tweet?text=Check out "+name+" located at "+address+". Website: "+website+"&hashtags=TravelAndEntertainmentSearch";
                console.log(url);
                window.open(url,"newWindow",'height=600,width=450');
            }
    
            function clean(){
                console.log("clear");
               document.getElementById("customized").disabled = true;
            }   
        
            function disable(){
                var otherLocation = document.getElementById("customized");
                otherLocation.disabled = true;
                otherLocation.value = "";
            }
            function enable(){
                var otherLocation = document.getElementById("customized");
                otherLocation.disabled = false;
                otherLocation.required = true;
                
            }

            function initAutocomplete() {
            // Create the autocomplete object, restricting the search to geographical
            // location types.
            
            
            autocomplete1 = new google.maps.places.Autocomplete(
                /** @type {!HTMLInputElement} */(document.getElementById('customized')),
                {types: ['geocode']});
            autocomplete2 = new google.maps.places.Autocomplete(
                /** @type {!HTMLInputElement} */(document.getElementById('mapFrom')),
                {types: ['geocode']});
            // When the user selects an address from the dropdown, populate the address
            // fields in the form.
            autocomplete1.addListener('place_changed', fillInAddress);
            autocomplete2.addListener('place_changed', fillInAddress); 
          }

          function fillInAddress() {
            // Get the place details from the autocomplete object.
            var place1 = autocomplete1.getPlace();
            var place2 = autocomplete2.getPlace();

            for (var component in componentForm) {
              document.getElementById(component).value = '';
              document.getElementById(component).disabled = false;
            }

            // Get each component of the address from the place details
            // and fill the corresponding field on the form.
            for (var i = 0; i < place1.address_components.length; i++) {
              var addressType = place1.address_components[i].types[0];
              if (componentForm[addressType]) {
                var val = place1.address_components[i][componentForm[addressType]];
                document.getElementById(addressType).value = val;
              }
            }
            for (var i = 0; i < place2.address_components.length; i++) {
              var addressType = place2.address_components[i].types[0];
              if (componentForm[addressType]) {
                var val = place1.address_components[i][componentForm[addressType]];
                document.getElementById(addressType).value = val;
              }
            }
          }

          // Bias the autocomplete object to the user's geographical location,
          // as supplied by the browser's 'navigator.geolocation' object.
          function geolocate1() {
            if (navigator.geolocation) {
              navigator.geolocation.getCurrentPosition(function(position) {
                var geolocation = {
                  lat: position.coords.latitude,
                  lng: position.coords.longitude
                };
                var circle = new google.maps.Circle({
                  center: geolocation,
                  radius: position.coords.accuracy
                });
                autocomplete1.setBounds(circle.getBounds());
              });
            }
          }
        function geolocate2() {
            if (navigator.geolocation) {
              navigator.geolocation.getCurrentPosition(function(position) {
                var geolocation = {
                  lat: position.coords.latitude,
                  lng: position.coords.longitude
                };
                var circle = new google.maps.Circle({
                  center: geolocation,
                  radius: position.coords.accuracy
                });
                autocomplete2.setBounds(circle.getBounds());
              });
            }
          }
    
        function initMap(lat,lon) {
            var directionsService = new google.maps.DirectionsService;
            var directionsDisplay = new google.maps.DirectionsRenderer;
                
            var mapOptions = {
                center: new google.maps.LatLng(lat, lon),
                zoom: 10,
                mapTypeId: google.maps.MapTypeId.HYBRID
            }
            
            var map = new google.maps.Map(document.getElementById("mapHere"), mapOptions);
            var marker = new google.maps.Marker({
                position: {lat:lat,lng:lon},
                map: map
            });
            panorama = map.getStreetView();
            panorama.setPosition({lat:lat,lng:lon});
            panorama.setPov(/** @type {google.maps.StreetViewPov} */({
              heading: 265,
              pitch: 0
            }));
            directionsDisplay.setMap(map);
            directionsDisplay.setPanel(document.getElementById('panel'));
            document.getElementById("getDirection").addEventListener('click',function(){
                        
                calculateAndDisplayRoute(map,directionsDisplay,directionsService,marker);
                        
            })
            
        }

        function toggleStreetView() {
            
            
            var toggle = panorama.getVisible();
            if (toggle == false) {
                $("#streetView").attr("src","map.png");
              panorama.setVisible(true);
            } else {
                console.log("toggle viw");
                $("#streetView").attr("src","street.png");
              panorama.setVisible(false);
            }
        }    
    
        function ipApi(){
                    var xmlhttp = new XMLHttpRequest();
                    xmlhttp.open("GET","http://ip-api.com/json",false);
                    xmlhttp.send();
                    jsonDoc =xmlhttp.responseText;
                    return jsonDoc;

                }
        function calculateAndDisplayRoute(map,directionsDisplay,directionsService,marker) {
                marker.setMap(null);
                var selectedMode = document.getElementById('travelMode').value;
                var originTemp = $('#mapFrom').val();
                if(originTemp =="Your location"){
                    console.log("your location");
                    var a = new XMLHttpRequest();
                    a.open("GET","http://ip-api.com/json",false);
                    a.send();
                    ip =JSON.parse(a.responseText);
                    
                    console.log("ipApi is");
                    console.log(ip);
                    var origin = {lat:ip.lat,lng:ip.lon};
                }else{
                    var origin=originTemp;
                }
                var destination = $('#mapTo').val();
                directionsService.route({
                  origin: origin,  // Haight.
                  destination: destination, 
                  // Ocean Beach.
                  // Note that Javascript allows us to access the constant
                  // using square brackets and a string value as its
                  // "property."
                  travelMode: google.maps.TravelMode[selectedMode],
                  provideRouteAlternatives:true
                }, function(response, status) {
                  if (status == 'OK') {
                    directionsDisplay.setDirections(response);
                      
                  } else {
                    window.alert('Directions request failed due to ' + status);
                  }
                });
              }
        function showPhotos(place_id){
            console.log("place_id is");
            console.log(place_id);
            var map = new google.maps.Map(document.getElementById("mapHelper"));
            var request = {
              placeId: place_id
            };

            service = new google.maps.places.PlacesService(map);
            service.getDetails(request, callback);

            function callback(place, status) {
              if (status == google.maps.places.PlacesServiceStatus.OK) {
                  //console.log("get details done");
                 //console.log(place.photos[0].getUrl({'maxWidth': 35, 'maxHeight': 35}));
                  if(place.photos && place.photos.length!=0){
                      displayPhotos(place);
                      $("#NoRecordPhotos").hide();
                      $("#photos").show();
                  }else{
                      console.log("no photos");
                      $("#NoRecordPhotos").show();
                      $("#photos").hide();
                  }
                  
              }
            }
        }
        
        function displayPhotos(obj){
             $('#photos').html("<div class='row'><div id='firstCol' class='col-sm-3' style=''></div><div id='secondCol' class='col-sm-3' style=''></div><div id='thirdCol' class='col-sm-3' style=''></div><div id='fourthCol' class='col-sm-3' style=''></div></div>");
            var count = 0;
  
            //console.log("obj.photos.length"+obj.photos.length);
            for(i=0;i<obj.photos.length;i++){
                if(count==0){
                    console.log(obj.photos[i].width);
                    document.getElementById('firstCol').innerHTML+= "<img id='"+i+"' class='img' src='"+obj.photos[i].getUrl({'maxWidth': 700})+"' style='height:auto;width:100%;margin-bottom:10px' onclick=window.open('"+obj.photos[i].getUrl({'maxWidth': obj.photos[i].width})+"')>";
                    //addListener(i,obj);
                    
                }
                if(count==1){
                     document.getElementById('secondCol').innerHTML+= "<img class='img' src='"+obj.photos[i].getUrl({'maxWidth': 700})+"' style='height:auto;width:100%;margin-bottom:10px' onclick=window.open('"+obj.photos[i].getUrl({'maxWidth': obj.photos[i].width})+"')>";
                }
                if(count==2){
                     document.getElementById('thirdCol').innerHTML+= "<img class='img' src='"+obj.photos[i].getUrl({'maxWidth': 700})+"' style='height:auto;width:100%;margin-bottom:10px' onclick=window.open('"+obj.photos[i].getUrl({'maxWidth':obj.photos[i].width})+"')>";
                }
                if(count==3){
                    document.getElementById('fourthCol').innerHTML += "<img class='img' src='"+obj.photos[i].getUrl({'maxWidth': 700})+"' style='height:auto;width:100%;margin-bottom:10px' onclick=window.open('"+obj.photos[i].getUrl({'maxWidth': obj.photos[i].width})+"')>";
                }
                

                if(count==3){
                    count=0;
                    
                }
                else{
                    count++;
                }
                
            }
    
        }
        
             function writeNextPage(json){
            
            //title
            var toWrite = "";
                
            toWrite += "<td><h style='font-weight:bold;'>#</h></td>";
            toWrite += "<td><h style='font-weight:bold;'>Category</h></td>";
            toWrite += "<td><h style='font-weight:bold;'>Name</h></td>";
            toWrite += "<td><h style='font-weight:bold;'>Address</h></td>";
            toWrite += "<td><h style='font-weight:bold;'>Favorite</h></td>";
            toWrite += "<td><h style='font-weight:bold;'>Details</h></td>";
            toWrite += "</tr>";
            //loop for each result

            for (i=0;i<json.results.length;i++){
                toWrite += "<tr>";
                toWrite += "<td>"+i+"</td>";
                toWrite += "<td><img src = '"+json.results[i].icon+"'></p=img></td>";
                toWrite += "<td><p>"+json.results[i].name+"</p></td>";
                toWrite += "<td><p style='cursor:hand;font-weight:normal;'>"+ json.results[i].vicinity+"</p></td>";

                toWrite += "<td><button style='font-size:20px' ><i class='fa fa-star-o'></i></button>";
                toWrite += "<td><button style='font-size:20px' value='"+json.results[i].place_id+"' onclick=getDetails(this)><i class='fa fa-angle-right'></i></button>";

                toWrite += "</tr>";

            }

            toWrite += "</table>";
            //console.log(toWrite);


        document.getElementById("nextPage").innerHTML=toWrite;
            
        }
        function getDetails(place_id){
                //document.getElementById('infoTable').ng-hide=true;
                  console.log("getting details");
                console.log(place_id);
                var returnDetails;
                var request = {
                    placeId: place_id
                        };

                    var service = new google.maps.places.PlacesService(document.createElement('div'));
                    service.getDetails(request, callback);

                    function callback(place, status) {
                      if (status == google.maps.places.PlacesServiceStatus.OK) {
                          console.log("library response");
                            //console.log(place);
                            returnDetails = place;


                      }
                    }
            return returnDetails;
            }

        function fillHours(obj,utc_offset){
            var day = moment().utcOffset(utc_offset).format('dddd');
            var toWrite ="";
            if(obj.open_now==true){
                if (day == "Monday"){
                    toWrite +="Open now:"+obj.weekday_text[0].replace("Monday:","");
                }
                if (day == "Tuesday"){
                    toWrite +="Open now:"+obj.weekday_text[1].replace("Tuesday:","");
                }
                if (day == "Wednesday"){
                    toWrite +="Open now:"+obj.weekday_text[2].replace("Wednesday:","");
                }
                if (day == "Thursday"){
                    toWrite +="Open now:"+obj.weekday_text[3].replace("Thursday:","");
                }
                if (day == "Friday"){
                    toWrite +="Open now:"+obj.weekday_text[4].replace("Friday:","");
                }
                if (day == "Saturday"){
                    toWrite +="Open now:"+obj.weekday_text[5].replace("Saturday:","");
                }
                if (day == "Sunday"){
                    toWrite +="Open now:"+obj.weekday_text[6].replace("Sunday:","");
                } 
            }
            else{
                toWrite = "closed";
            }
            return toWrite;

        }

        function fillstar(rating,id){
           // console.log(id);
            const starPercentage = (rating / 5) * 100;
          const starPercentageFinal = `${(starPercentage)}%`;
          document.getElementById(id).style.width = starPercentageFinal; 
           // console.log(starPercentageFinal);
        }
        function fillPrice(price_level){
            var toWrite ="";
            var i;
            for(i=0;i<price_level;i++){
                toWrite+="$";
            }
            return toWrite;
        }
            //change this
        
        function putInput(){
            $("#mapFrom").val("Your location");
            $("#mapTo").val($("#placeName").html()+" "+$("#address").html());
        }
        function writeReviewsBlock(reviews, yelp_reviews){
            var toWrite = "<div class='row' id='biggerFrame'><select id='select1' class='btn btn-primary' style='float:left;margin-left:20px'><option value='Google_reviews'>Google Reviews</option><option value='yelp_reviews'>Yelp Reviews</option></select>";
            
            toWrite += "<select id='select2' class='btn btn-primary' style='float:left;margin-left:20px'><option value='1'>Default Order</option><option value='2'>Highest Rating</option><option value='3'>Lowest Rating</option><option value='4'>Most Recent</option><option value='5'>Least Recent</option></select></div>";
            $("#twoButtons").html(toWrite);
            
            var origReviews = reviews.slice();
            var origYelpReviews = yelp_reviews.slice();
            
            $('#select1, #select2').on('change', function(){
                if($("#select2").val()=="1" && $("#select1").val()=="Google_reviews" ){
                        writeReviews(origReviews);
                    
                   }
                
                if($("#select2").val()=="2"&& $("#select1").val()=="Google_reviews"){
                    reviews.sort(function(a,b){
                        return a.rating< b.rating;
                    });
                    writeReviews(reviews);
                }
                if($("#select2").val()=="3"&& $("#select1").val()=="Google_reviews"){
                    reviews.sort(function(a,b){
                        return a.rating> b.rating;
                    });
                    writeReviews(reviews);
                }
                if($("#select2").val()=="4"&& $("#select1").val()=="Google_reviews"){
                    reviews.sort(function(a,b){
                        return a.time<b.time;
                    });
                    writeReviews(reviews);
                }
                if($("#select2").val()=="5"&& $("#select1").val()=="Google_reviews"){
                    reviews.sort(function(a,b){
                        return a.time> b.time;
                    });
                    writeReviews(reviews);
                }
                
                
                if($("#select2").val()=="1" && $("#select1").val()=="yelp_reviews" ){
                        writeYelpReviews(origYelpReviews);
                   }
                
                if($("#select2").val()=="2"&& $("#select1").val()=="yelp_reviews"){
                    yelp_reviews.sort(function(a,b){
                        return a.rating< b.rating;
                    });
                    writeYelpReviews(yelp_reviews);
                }
                if($("#select2").val()=="3"&& $("#select1").val()=="yelp_reviews"){
                    yelp_reviews.sort(function(a,b){
                        return a.rating> b.rating;
                    });
                    writeYelpReviews(yelp_reviews);
                }
                if($("#select2").val()=="4"&& $("#select1").val()=="yelp_reviews"){
                    yelp_reviews.sort(function(a,b){
                        return toTime(a.time_created)<toTime(b.time_created);
                    });
                    writeYelpReviews(yelp_reviews);
                }
                if($("#select2").val()=="5"&& $("#select1").val()=="yelp_reviews"){
                    yelp_reviews.sort(function(a,b){
                        return toTime(a.time_created)>toTime(b.time_created);
                    });
                    writeYelpReviews(yelp_reviews);
                }
                
                
                
                
            });
            
            
            writeReviews(reviews);
  
        }
        function writeYelpReviews(reviews){
            console.log(reviews);
            var toWrite = "";
            if(reviews.length!=0){
                var length = reviews.length;
            }else{
                var length = 0;
                toWrite = "<p style='background-color: antiquewhite;margin-top:50px;margin-bottom:50px'>No records</p>";
            }
            for(i=0;i<length;i++){
                toWrite += "<div class='row borderline' style='margin-top:10px'><div style='width:10%'><a href='"+reviews[i].user.image_url+"'><img src="+reviews[i].user.image_url+" style='width:100%'></a></div>";
                
                toWrite += "<div class='col'><a href='"+reviews[i].url+"' style='text-decoration:none'>"+reviews[i].user.name+"</a>";
                
                
                toWrite += "<p><div class='stars-outer'><div class='stars-inner' id='rating_star"+i+"'></div></div>";
                
                
                
                toWrite +=reviews[i].time_created;
                
                toWrite += "<p>"+reviews[i].text+"</p>"
                toWrite +="</div></div>";
                
//                fillstar(reviews[i].rating,"rating_star"+i);
            }
            document.getElementById("reviewContent").innerHTML =toWrite;
            for(i=0;i<length;i++){
                fillstar(reviews[i].rating,"rating_star"+i);
            }
            
        }
        function toTime(time_created){
            return Date.parse(time_created);
        }
        function writeReviews(reviews){
            console.log(reviews);
            var toWrite = "";
            
            for(i=0;i<reviews.length;i++){
                toWrite += "<div class='container'><div class='row borderline' style='margin-top:10px'><div class='col-xs-2' style='padding:0px'><a href='"+reviews[i].author_url+"'><img src="+reviews[i].profile_photo_url+" style='width:80%'></a></div>";
                
                toWrite += "<div class='col-xs-10'><a href='"+reviews[i].author_url+"' style='text-decoration:none'>"+reviews[i].author_name+"</a>";
                
                
                toWrite += "<p><div class='stars-outer'><div class='stars-inner' id='rating_star"+i+"'></div></div>";
                
                
                
                toWrite +=getTime(reviews[i].time);
                
                toWrite += "<p>"+reviews[i].text+"</p>"
                toWrite +="</div></div></div>";
                
//                fillstar(reviews[i].rating,"rating_star"+i);
            }
            document.getElementById("reviewContent").innerHTML =toWrite;
            for(i=0;i<reviews.length;i++){
                fillstar(reviews[i].rating,"rating_star"+i);
            }
            
        }
        function getTime(timeStamp){
              var a = new Date(timeStamp * 1000);
              var year = a.getFullYear();
              var month =a.getMonth();
              var date = a.getDate();
              var hour = a.getHours();
              var min = a.getMinutes();
              var sec = a.getSeconds();
              var time = year + '-' + month + '-' + date + ' ' + hour + ':' + min + ':' + sec ;
              return time;

        }
        function contains(a, obj) {
            console.log("conataining");
            for (var i = 0; i < a.length; i++) {
                if (a[i].place_id === obj.place_id) {
                    console.log("contain true");
                    return true;
                }
            }
            return false;
        }
        function getIndex(a, obj){
            console.log("getting index");
            for (var i = 0; i < a.length; i++) {
                if (a[i].place_id === obj.place_id) {
                    console.log("got it");
                    return i;
                }
            }
            
        }
        
</script>
<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDdFu4bO4wYReuonZxKBLg6qHBgyQX7IkQ&libraries=places&callback=initAutocomplete" async defer></script>    

</html>
